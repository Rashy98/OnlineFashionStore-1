let User;_960‍.w("../models/user",[["default",["User"],function(v){User=v}]]);
const router = require('express').Router();

router.post("/addToWishList", (req, res) => {

    User.findOne({_id: req.body.userId}, (err, user) => {

        let duplicate = false;

        user.WishList.forEach((wishList) => {
            if(wishList.id === req.body.productId){
                duplicate = true;
            }
        });

        if(!duplicate){
            User.findOneAndUpdate({_id: req.body.userId},
                {
                    $push : {
                        WishList: {
                            id : req.body.productId,
                            name : req.body.name,
                            img : req.body.img
                        }
                    }
                },
                {new:true},
                (err, user) => {
                    if(err) return res.json({success:false, err});
                    res.status(200).json(user.WishList)
                }
            )
        }

    })
});

router.get('/getWishList', (req, res) => {

    if(req.query.userId !== undefined){
        User.findOne({_id: req.query.userId}
            ,(err, user) => {

                res.json(user.WishList);

            })
    }
});

module.exports = router;